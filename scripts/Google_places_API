{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "77f6d88e-13b3-4ad4-a00b-a6b83629da14",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting googlemaps\n",
      "  Downloading googlemaps-4.10.0.tar.gz (33 kB)\n",
      "  Preparing metadata (setup.py): started\n",
      "  Preparing metadata (setup.py): finished with status 'done'\n",
      "Requirement already satisfied: requests<3.0,>=2.20.0 in c:\\users\\mafer\\anaconda3\\lib\\site-packages (from googlemaps) (2.32.3)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in c:\\users\\mafer\\anaconda3\\lib\\site-packages (from requests<3.0,>=2.20.0->googlemaps) (3.3.2)\n",
      "Requirement already satisfied: idna<4,>=2.5 in c:\\users\\mafer\\anaconda3\\lib\\site-packages (from requests<3.0,>=2.20.0->googlemaps) (3.7)\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in c:\\users\\mafer\\anaconda3\\lib\\site-packages (from requests<3.0,>=2.20.0->googlemaps) (2.3.0)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in c:\\users\\mafer\\anaconda3\\lib\\site-packages (from requests<3.0,>=2.20.0->googlemaps) (2025.4.26)\n",
      "Building wheels for collected packages: googlemaps\n",
      "  Building wheel for googlemaps (setup.py): started\n",
      "  Building wheel for googlemaps (setup.py): finished with status 'done'\n",
      "  Created wheel for googlemaps: filename=googlemaps-4.10.0-py3-none-any.whl size=40749 sha256=15dda8398b4560a69595c753d20310442c428f43fcd6541ff483bd44d9c21d9b\n",
      "  Stored in directory: c:\\users\\mafer\\appdata\\local\\pip\\cache\\wheels\\76\\2a\\24\\5993a7b77c9a37b86f415096436a448c1babdd132066bdcb31\n",
      "Successfully built googlemaps\n",
      "Installing collected packages: googlemaps\n",
      "Successfully installed googlemaps-4.10.0\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "  DEPRECATION: Building 'googlemaps' using the legacy setup.py bdist_wheel mechanism, which will be removed in a future version. pip 25.3 will enforce this behaviour change. A possible replacement is to use the standardized build interface by setting the `--use-pep517` option, (possibly combined with `--no-build-isolation`), or adding a `pyproject.toml` file to the source tree of 'googlemaps'. Discussion can be found at https://github.com/pypa/pip/issues/6334\n"
     ]
    }
   ],
   "source": [
    "pip install googlemaps"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "62ccca6d-a9ce-4e12-9c78-a97ac23d2b9c",
   "metadata": {},
   "outputs": [],
   "source": [
    "import googlemaps\n",
    "# ---------------------------------------------------------\n",
    "# PARTE 1: CONFIGURACIÃ“N\n",
    "# ---------------------------------------------------------\n",
    "# Colocamos nuestra API key\n",
    "API_KEY = 'AIzaSyA9yU8036YYM6pXyYOPAHEsV-AUJKT2YYU'\n",
    "gmaps = googlemaps.Client(key=API_KEY)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "ab5e9ae5-9cc0-44e4-bedd-db42a5bc0e96",
   "metadata": {},
   "outputs": [],
   "source": [
   "# ---------------------------------------------------------\n",
    "# PARTE 2: LAS FUNCIONES \n",
    "# ---------------------------------------------------------\n",
    "\n",
    "def obtener_coordenadas_de_nombre(nombre_lugar):\n",
    "    \"\"\" Convierte un nombre (ej. 'Plaza de Armas') en coordenadas. \"\"\"\n",
    "    print(f\"ğŸ” Buscando coordenadas para: '{nombre_lugar}'...\")\n",
    "    respuesta = gmaps.geocode(nombre_lugar)\n",
    "    \n",
    "    if respuesta:\n",
    "        ubicacion = respuesta[0]['geometry']['location']\n",
    "        direccion = respuesta[0]['formatted_address']\n",
    "        print(f\"ğŸ“ DirecciÃ³n encontrada: {direccion}\")\n",
    "        return ubicacion['lat'], ubicacion['lng']\n",
    "    else:\n",
    "        print(\"âŒ No se encontrÃ³ el lugar.\")\n",
    "        return None, None\n",
    "\n",
    "def calcular_nota_servicios(parques, transporte, restaurantes):\n",
    "\n",
    "    # 1. TRANSPORTE (Max 4 puntos) \n",
    "    if transporte >= 8:\n",
    "        nota_transporte = 4.0\n",
    "    else:\n",
    "        nota_transporte = transporte * 0.5 \n",
    "\n",
    "    # 2. PARQUES (Max 3 puntos) \n",
    "    if parques > 3: \n",
    "        nota_parques = 3.0\n",
    "    else:\n",
    "        nota_parques = parques * 0.75 \n",
    "        \n",
    "    # 3. RESTAURANTES (Max 3 puntos) \n",
    "    if restaurantes >= 5:\n",
    "        nota_restaurantes = 3.0\n",
    "    else:\n",
    "        nota_restaurantes = restaurantes * 0.6\n",
    "\n",
    "    return nota_transporte + nota_parques + nota_restaurantes\n",
    "\n",
    "# Solo la nota de comisarÃ­a\n",
    "def calcular_nota_seguridad(policia):\n",
    " # 1. COMISARÃA (Max 3 puntos)\n",
    "    if policia >= 1:\n",
    "        return 10.0\n",
    "    else:\n",
    "        return 0.0\n",
    "\n",
    "def analizar_zona_google(lat, lon):\n",
    "\n",
    "    print(\"ğŸ“Š Analizando el entorno (500m a la redonda)...\")\n",
    "    \n",
    "    # --- A. OBTENCIÃ“N DE DATOS (API) ---\n",
    "    \n",
    "    # 1. Restaurantes\n",
    "    res_restaurantes = gmaps.places_nearby(location=(lat, lon), radius=500, type='restaurant')\n",
    "    num_restaurantes = len(res_restaurantes.get('results', []))\n",
    "\n",
    "    # 2. Parques\n",
    "    res_parques = gmaps.places_nearby(location=(lat, lon), radius=500, type='park')\n",
    "    num_parques = len(res_parques.get('results', []))\n",
    "    \n",
    "    # 3. PolicÃ­a (Seguridad) - Radio 1km\n",
    "    res_policia = gmaps.places_nearby(location=(lat, lon), radius=1000, type='police')\n",
    "    num_policia = len(res_policia.get('results', []))\n",
    "\n",
    "    # 4. Transporte\n",
    "    res_transporte = gmaps.places_nearby(location=(lat, lon), radius=500, type='transit_station')\n",
    "    num_transporte = len(res_transporte.get('results', []))\n",
    "\n",
    "    # --- B. CÃLCULO DE NOTA  ---\n",
    "    \n",
    "    puntaje_calculado = (calcular_nota_servicios(num_parques, num_transporte, num_restaurantes)*0.2)\n",
    "    puntaje_policia = (calcular_nota_seguridad(num_policia)*0.08)\n",
    "\n",
    "    # --- C. RESULTADO FINAL SERVICIOS (20%) ---\n",
    "    return {\n",
    "        \"cantidades\": {\n",
    "            \"restaurantes\": num_restaurantes,\n",
    "            \"parques\": num_parques,\n",
    "            \"policia\": num_policia,\n",
    "            \"transporte\": num_transporte\n",
    "        },\n",
    "        \"puntaje_total\": round(puntaje_calculado, 2),\n",
    "        # --- C.2 RESULTADO FINAL POLICIA (solo un 20% del 40% de la puntuaciÃ³n de SEGURIDAD)\n",
    "        \"puntaje_total_policia\": round(puntaje_policia, 2)\n",
    "    }\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "5d75524f-7ff6-4000-8245-d2ce1d1459fd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "ğŸ” Buscando coordenadas para: 'Ceres, Ate'...\n",
      "ğŸ“ DirecciÃ³n encontrada: Ate, Peru\n",
      "ğŸ“Š Analizando el entorno (500m a la redonda)...\n",
      "\n",
      "============================================================\n",
      "   ANÃLISIS DE SERVICIOS (20% del total): Ceres, Ate\n",
      "============================================================\n",
      "ğŸšŒ Transporte:    13\n",
      "ğŸŒ³ Parques:       2\n",
      "ğŸ½ï¸ Restaurantes:  20\n",
      "------------------------------------------------------------\n",
      "â­ NOTA FINAL:    1.7\n",
      "============================================================\n",
      "============================================================\n",
      "--- ğŸ›¡ï¸ BLOQUE SEGURIDAD ( 8% del total) ---\n",
      "ğŸ‘® ComisarÃ­as:    1 encontradas (1km)\n",
      "------------------------------------------------------------\n",
      "ğŸ‘‰ NOTA INFRAESTRUCTURA POLICIAL: 0.8\n",
      "============================================================\n"
     ]
    }
   ],
   "source": [

